 - name: Create a full clone of template 9999
   community.general.proxmox_kvm:
      node: "artoria"
      api_user: "root@pam"
      api_password: "{{ password }}"
      api_host: "artoria"
      clone: template
      vmid: 9999
      newid: "{{ vmid }}"
      name: "{{ hostname }}"
        #clone_type: "full" 
      storage: "local-zfs"
      format: "raw"

 - name: modify vm to specified specs 
   community.general.proxmox_kvm:
      node: "artoria"
      api_user: "root@pam"
      api_password: "{{ password }}"
      api_host: "artoria"
      vmid: "{{ vmid }}"
      cores: "{{ cpu }}"
      memory: "{{ mem }}"
        #     net:
        # net0: "virtio, tag={{ vlanTag }}" 
      ipconfig: 
        ipconfig0: "ip={{ ipadr }},gw={{ gateway  }}"
      update: true

 - name: change netadapter
   community.general.proxmox_nic:
     api_host: "artoria"
     api_user: "root@pam"
     api_password: "{{ password }}"
     name: "{{ hostname }}"
     vmid: "{{ vmid }}"
     interface: net0
     bridge: default(omit)
     tag: "{{ vlanTag }}"

 - name: resize the disk
   shell: qm resize {{ vmid }} scsi0 +{{ disksize }}G
